<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climate Quest: “ö–∞–∑–∞“õ—Å—Ç–∞–Ω –∂”ô–Ω–µ ”ò–ª–µ–º</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #2c3e50;
            --neon-blue: #00d2ff;
            --neon-green: #39ff14;
        }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', Tahoma, sans-serif; background: #f4f7f6; overflow: hidden; }
        .container { display: flex; height: 100vh; }
        #side-panel {
            width: 350px; background: white; padding: 20px;
            box-shadow: 4px 0 15px rgba(0,0,0,0.1);
            display: flex; flex-direction: column; z-index: 1000;
        }
        #map { flex-grow: 1; z-index: 1; background: #aad3df; }
        .factor-card {
            background: #fff; border-radius: 12px; padding: 15px;
            margin-bottom: 15px; border: 2px solid #eee;
        }
        .factor-item { margin: 8px 0; font-size: 1rem; color: #444; }
        .neon-btn {
            background: #222; color: var(--neon-blue);
            border: 2px solid var(--neon-blue);
            padding: 12px; border-radius: 8px; cursor: pointer;
            font-size: 1rem; font-weight: bold;
            text-transform: uppercase; transition: 0.3s;
            margin-top: 10px;
        }
        .neon-btn:hover { background: var(--neon-blue); color: #000; }
        .custom-tooltip {
            background: rgba(0, 0, 0, 0.8); border: 1px solid var(--neon-blue);
            color: white; font-weight: bold; padding: 5px; border-radius: 5px;
        }
        .modal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; padding: 25px; border-radius: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.2); z-index: 2000;
            display: none; text-align: center; width: 300px;
        }
    </style>
</head>
<body>

<audio id="sound-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
<audio id="sound-wrong" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

<div class="container">
    <div id="side-panel">
        <h2 style="text-align:center;">üåç Climate Quest</h2>
        <p id="round-info" style="text-align:center; font-weight:bold;">–î–µ“£–≥–µ–π: 1 / 10</p>
        
        <div class="factor-card">
            <div class="factor-item">üå° –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: <b id="f-temp">?</b></div>
            <div class="factor-item">üåß –ñ–∞—É—ã–Ω-—à–∞—à—ã–Ω: <b id="f-rain">?</b></div>
            <div class="factor-item">‚õ∞ –†–µ–ª—å–µ—Ñ: <b id="f-relief">?</b></div>
        </div>

        <div id="timer" style="font-size: 20px; text-align:center; margin-bottom: 10px; font-weight:bold; color:#e74c3c">00:00</div>

        <div style="display:flex; justify-content: space-around; margin-bottom: 10px;">
            <div style="color:green">–î“±—Ä—ã—Å: <span id="s-correct">0</span></div>
            <div style="color:red">“ö–∞—Ç–µ: <span id="s-wrong">0</span></div>
        </div>

        <button class="neon-btn" onclick="startGame()" id="start-btn">–û–π—ã–Ω–¥—ã –±–∞—Å—Ç–∞—É</button>
    </div>

    <div id="map"></div>
</div>

<div id="result-modal" class="modal">
    <h3 id="modal-title"></h3>
    <p id="modal-text"></p>
    <button class="neon-btn" onclick="closeModal()" style="width:100%">–ñ–∞–ª“ì–∞—Å—Ç—ã—Ä—É</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const climateZones = [
        { name: "–°–æ–ª—Ç“Ø—Å—Ç—ñ–∫ –ú“±–∑–¥—ã –º“±—Ö–∏—Ç (–ê—Ä–∫—Ç–∏–∫–∞)", temp: "-30¬∞C", rain: "150 –º–º", relief: "–ú“±–∑–¥—ã “Ø—Å—Ç—ñ—Ä—Ç", coords: [[70, -180], [85, -180], [85, 180], [70, 180]], color: "#a5b1c2" },
        { name: "–ê–º–∞–∑–æ–Ω–∫–∞ –æ–π–ø–∞—Ç—ã (–≠–∫–≤–∞—Ç–æ—Ä)", temp: "+28¬∞C", rain: "3000 –º–º", relief: "–´–ª“ì–∞–ª–¥—ã –∂–∞–∑—ã“õ", coords: [[-5, -75], [5, -75], [5, -50], [-5, -50]], color: "#26de81" },
        { name: "–°–∞—Ö–∞—Ä–∞ —à”©–ª—ñ (–ê—Ñ—Ä–∏–∫–∞)", temp: "+45¬∞C", rain: "50 –º–º", relief: "“ö“±–º–¥—ã —à–∞“ì—ã–ª–¥–∞—Ä", coords: [[15, -10], [30, -10], [30, 35], [15, 35]], color: "#fd9644" },
        { name: "“ö–∞–∑–∞“õ—Å—Ç–∞–Ω –¥–∞–ª–∞—Å—ã (“ö–æ“£—ã—Ä–∂–∞–π)", temp: "+25¬∞C / -20¬∞C", rain: "350 –º–º", relief: "–ñ–∞–∑—ã“õ –¥–∞–ª–∞", coords: [[45, 50], [55, 50], [55, 85], [40, 85]], color: "#f7b731" },
        { name: "–ê–Ω—Ç–∞—Ä–∫—Ç–∏–¥–∞ –º“±–∑–¥—ã“ì—ã", temp: "-60¬∞C", rain: "100 –º–º", relief: "–ë–∏—ñ–∫ –º“±–∑ –∂–∞–º—ã–ª“ì—ã—Å—ã", coords: [[-88, -180], [-65, -180], [-65, 180], [-88, 180]], color: "#45aaf2" },
        { name: "–ê—É—Å—Ç—Ä–∞–ª–∏—è–Ω—ã“£ “Ø–ª–∫–µ–Ω —à”©–ª—ñ", temp: "+38¬∞C", rain: "200 –º–º", relief: "“Æ—Å—Ç—ñ—Ä—Ç—Ç—ñ –∞–π–º–∞“õ", coords: [[-30, 120], [-15, 120], [-15, 150], [-30, 150]], color: "#eb3b5a" },
        { name: "–ë–∞—Ç—ã—Å –ï—É—Ä–æ–ø–∞ –∂–∞“ì–∞–ª–∞—É—ã", temp: "+18¬∞C", rain: "1000 –º–º", relief: "–¢”©–±–µ–ª—ñ –∂–∞–∑—ã“õ", coords: [[45, -5], [60, -5], [60, 15], [45, 15]], color: "#4b7bec" },
        { name: "–û“£—Ç“Ø—Å—Ç—ñ–∫-–®—ã“ì—ã—Å –ê–∑–∏—è (–ú—É—Å—Å–æ–Ω)", temp: "+26¬∞C", rain: "2500 –º–º", relief: "–¢–∞—É–ª—ã-–æ—Ä–º–∞–Ω–¥—ã", coords: [[10, 95], [22, 95], [22, 115], [10, 115]], color: "#20bf6b" },
        { name: "–ñ–µ—Ä–æ—Ä—Ç–∞ —Ç–µ“£—ñ–∑—ñ –∂–∞“ì–∞–ª–∞—É—ã", temp: "+24¬∞C / +12¬∞C", rain: "700 –º–º", relief: "–¢–∞—É–ª—ã –∂–∞“ì–∞–ª–∞—É", coords: [[32, 5], [42, 5], [42, 30], [32, 30]], color: "#fc5c65" },
        { name: "–¢–∏–±–µ—Ç —Ç–∞—É–ª—ã “Ø—Å—Ç—ñ—Ä—Ç—ñ", temp: "+8¬∞C", rain: "300 –º–º", relief: "–ë–∏—ñ–∫ —Ç–∞—É", coords: [[28, 78], [37, 78], [37, 95], [28, 95]], color: "#778ca3" }
    ];

    let map, timerInterval, currentRound = 0, seconds = 0;
    let stats = { correct: 0, wrong: 0 };
    let usedIdx = [];

    function initMap() {
        // –ö–∞—Ä—Ç–∞–Ω—ã –∂–∞—Å–∞—É:zoom –º–µ–Ω –æ—Ä—Ç–∞–ª—ã“õ—Ç—ã –ê–Ω—Ç–∞—Ä–∫—Ç–∏–¥–∞ –∫”©—Ä—ñ–Ω–µ—Ç—ñ–Ω–¥–µ–π —Ä–µ—Ç—Ç–µ—É
        map = L.map('map', {
            minZoom: 1,
            maxZoom: 5,
            worldCopyJump: true
        }).setView([0, 0], 2);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(map);

        climateZones.forEach(zone => {
            let poly = L.polygon(zone.coords, {
                color: zone.color, weight: 2, fillColor: zone.color, fillOpacity: 0.1
            }).addTo(map);

            poly.bindTooltip(zone.name, { sticky: true, className: 'custom-tooltip' });
            poly.on('click', () => checkAnswer(zone, poly));
        });
    }

    function playSound(id) {
        const sound = document.getElementById(id);
        sound.currentTime = 0;
        sound.play().catch(() => {}); // –ë—Ä–∞—É–∑–µ—Ä —à–µ–∫—Ç–µ—É—ñ –±–æ–ª—Å–∞ “õ–∞—Ç–µ —à—ã“ì–∞—Ä–º–∞–π–¥—ã
    }

    function startGame() {
        document.getElementById('start-btn').style.display = 'none';
        nextRound();
        startTimer();
    }

    function startTimer() {
        timerInterval = setInterval(() => {
            seconds++;
            let m = Math.floor(seconds/60).toString().padStart(2,'0');
            let s = (seconds%60).toString().padStart(2,'0');
            document.getElementById('timer').innerText = `${m}:${s}`;
        }, 1000);
    }

    function nextRound() {
        if (currentRound >= 10) {
            alert(`–û–π—ã–Ω –±—ñ—Ç—Ç—ñ! “∞–ø–∞–π: ${stats.correct}/10. –£–∞“õ—ã—Ç: ${document.getElementById('timer').innerText}`);
            location.reload();
            return;
        }
        let rand;
        do { rand = Math.floor(Math.random() * climateZones.length); } while (usedIdx.includes(rand));
        usedIdx.push(rand);

        let q = climateZones[rand];
        document.getElementById('f-temp').innerText = q.temp;
        document.getElementById('f-rain').innerText = q.rain;
        document.getElementById('f-relief').innerText = q.relief;
        document.getElementById('round-info').innerText = `–î–µ“£–≥–µ–π: ${currentRound + 1} / 10`;
    }

    function checkAnswer(zone, layer) {
        if (document.getElementById('result-modal').style.display === 'block' || usedIdx.length === 0) return;

        let target = climateZones[usedIdx[currentRound]];
        if (zone.name === target.name) {
            stats.correct++;
            playSound('sound-correct');
            showModal("‚úÖ –î“±—Ä—ã—Å!", `${zone.name}`);
        } else {
            stats.wrong++;
            playSound('sound-wrong');
            showModal("‚ùå “ö–∞—Ç–µ", `–ë“±–ª - ${zone.name}. –°—ñ–∑–≥–µ ${target.name} –∫–µ—Ä–µ–∫ –µ–¥—ñ.`);
        }
        updateStats();
    }

    function updateStats() {
        document.getElementById('s-correct').innerText = stats.correct;
        document.getElementById('s-wrong').innerText = stats.wrong;
    }

    function showModal(title, text) {
        document.getElementById('modal-title').innerText = title;
        document.getElementById('modal-text').innerText = text;
        document.getElementById('result-modal').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('result-modal').style.display = 'none';
        currentRound++;
        nextRound();
    }

    window.onload = initMap;
</script>
</body>
</html>